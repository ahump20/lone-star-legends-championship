<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blaze Intelligence - Advanced Analytics Dashboard</title>
    
    <!-- Design Tokens -->
    <link rel="stylesheet" href="css/tokens.css">
    
    <!-- Chart.js for Data Visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Configuration -->
    <script src="js/config.js"></script>
    <script src="js/image-loader.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            background: var(--blaze-black);
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255, 107, 53, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(255, 215, 0, 0.05) 0%, transparent 50%);
            color: var(--blaze-white);
            min-height: 100vh;
        }

        /* Header */
        .dashboard-header {
            background: linear-gradient(135deg, var(--blaze-black), rgba(255, 107, 53, 0.1));
            border-bottom: 2px solid var(--blaze-orange);
            padding: 2rem;
            text-align: center;
        }

        .dashboard-title {
            font-family: var(--font-heading);
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--blaze-orange), var(--blaze-burnt-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .dashboard-subtitle {
            color: var(--blaze-text-secondary);
            font-size: 1.1rem;
        }

        /* Live Status */
        .live-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid var(--blaze-orange);
            border-radius: 50px;
            padding: 0.5rem 1.5rem;
            margin-top: 1rem;
        }

        .live-indicator {
            width: 10px;
            height: 10px;
            background: var(--blaze-orange);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 53, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 53, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 53, 0); }
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            padding: 1rem;
            flex-wrap: wrap;
        }

        .control-btn {
            background: linear-gradient(135deg, var(--blaze-burnt-orange), var(--blaze-orange));
            border: 2px solid var(--blaze-orange);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            padding: 2rem;
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Cards */
        .metric-card {
            background: rgba(26, 26, 26, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 107, 53, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-family: var(--font-heading);
            font-size: 1.25rem;
            color: var(--blaze-orange);
        }

        .card-icon {
            font-size: 1.5rem;
        }

        /* CEE Scores Grid */
        .cee-scores {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .cee-dimension {
            background: rgba(255, 107, 53, 0.05);
            border: 1px solid rgba(255, 107, 53, 0.2);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
        }

        .dimension-name {
            font-size: 0.9rem;
            color: var(--blaze-text-secondary);
            margin-bottom: 0.5rem;
        }

        .dimension-score {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--blaze-orange), var(--blaze-burnt-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .dimension-confidence {
            font-size: 0.8rem;
            color: var(--blaze-text-secondary);
            margin-top: 0.25rem;
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 1rem;
        }

        .chart-container.small {
            height: 200px;
        }

        /* Stats Table */
        .stats-table {
            width: 100%;
            margin-top: 1rem;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            border-bottom: 1px solid rgba(255, 107, 53, 0.1);
        }

        .stat-row:hover {
            background: rgba(255, 107, 53, 0.05);
        }

        .stat-label {
            color: var(--blaze-text-secondary);
        }

        .stat-value {
            font-weight: 600;
            color: var(--blaze-orange);
        }

        /* Performance Heatmap */
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 2px;
            margin-top: 1rem;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .heatmap-cell:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        .heat-cold { background: rgba(66, 165, 245, 0.3); }
        .heat-warm { background: rgba(255, 193, 7, 0.5); }
        .heat-hot { background: rgba(255, 107, 53, 0.7); }

        /* Player List */
        .player-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: rgba(255, 107, 53, 0.05);
            border-left: 3px solid var(--blaze-orange);
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .player-item:hover {
            background: rgba(255, 107, 53, 0.1);
            transform: translateX(5px);
        }

        .player-name {
            font-weight: 600;
        }

        .player-score {
            font-family: var(--font-heading);
            color: var(--blaze-orange);
        }

        /* Loading State */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 107, 53, 0.2);
            border-top-color: var(--blaze-orange);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
                padding: 1rem;
            }

            .cee-scores {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
            }

            .control-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="dashboard-header">
        <div style="display: flex; align-items: center; justify-content: center; gap: 1rem; margin-bottom: 1rem;">
            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--blaze-orange), var(--blaze-burnt-orange)); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 3rem; box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);">
                üî•
            </div>
        </div>
        <h1 class="dashboard-title">Blaze Intelligence Analytics</h1>
        <p class="dashboard-subtitle">Advanced Performance Metrics & CEE Normalization Engine</p>
        <div class="live-status">
            <span class="live-indicator"></span>
            <span id="connection-status">LIVE ‚Ä¢ 2.8M+ Data Points</span>
        </div>
    </header>

    <!-- Controls -->
    <div class="controls">
        <button class="control-btn" onclick="dashboard.startRealTime()">‚ñ∂Ô∏è Start Live Data</button>
        <button class="control-btn" onclick="dashboard.pauseRealTime()">‚è∏Ô∏è Pause</button>
        <button class="control-btn" onclick="dashboard.refreshData()">üîÑ Refresh</button>
        <button class="control-btn" onclick="dashboard.exportData()">üìä Export CSV</button>
        <button class="control-btn" onclick="dashboard.toggleMode()">üåô Dark Mode</button>
    </div>

    <!-- Dashboard Grid -->
    <div class="dashboard-grid">
        <!-- CEE Champion Score Card -->
        <div class="metric-card">
            <div class="card-header">
                <h3 class="card-title">Champion Enigma Engine‚Ñ¢</h3>
                <span class="card-icon">üß†</span>
            </div>
            <div class="cee-scores" id="cee-scores">
                <!-- CEE dimensions will be populated here -->
            </div>
        </div>

        <!-- Performance Trends -->
        <div class="metric-card">
            <div class="card-header">
                <h3 class="card-title">Performance Trends</h3>
                <span class="card-icon">üìà</span>
            </div>
            <div class="chart-container">
                <canvas id="performance-chart"></canvas>
            </div>
        </div>

        <!-- Live Statistics -->
        <div class="metric-card">
            <div class="card-header">
                <h3 class="card-title">Live Statistics</h3>
                <span class="card-icon">‚ö°</span>
            </div>
            <div class="stats-table" id="live-stats">
                <div class="stat-row">
                    <span class="stat-label">Exit Velocity</span>
                    <span class="stat-value" id="exit-velocity">--</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Launch Angle</span>
                    <span class="stat-value" id="launch-angle">--</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Sprint Speed</span>
                    <span class="stat-value" id="sprint-speed">--</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Decision Time</span>
                    <span class="stat-value" id="decision-time">--</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Success Rate</span>
                    <span class="stat-value" id="success-rate">--</span>
                </div>
            </div>
        </div>

        <!-- Zone Heatmap -->
        <div class="metric-card">
            <div class="card-header">
                <h3 class="card-title">Performance Heatmap</h3>
                <span class="card-icon">üéØ</span>
            </div>
            <div class="heatmap-grid" id="heatmap">
                <!-- Heatmap cells will be populated here -->
            </div>
        </div>

        <!-- Team Rankings -->
        <div class="metric-card">
            <div class="card-header">
                <h3 class="card-title">Team Rankings</h3>
                <span class="card-icon">üèÜ</span>
            </div>
            <div class="player-list" id="team-rankings">
                <!-- Player rankings will be populated here -->
            </div>
        </div>

        <!-- Biometric Monitor -->
        <div class="metric-card">
            <div class="card-header">
                <h3 class="card-title">Biometric Monitor</h3>
                <span class="card-icon">üíì</span>
            </div>
            <div class="chart-container small">
                <canvas id="biometric-chart"></canvas>
            </div>
            <div class="stats-table">
                <div class="stat-row">
                    <span class="stat-label">Heart Rate</span>
                    <span class="stat-value" id="heart-rate">-- bpm</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">HRV</span>
                    <span class="stat-value" id="hrv">-- ms</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Stress Level</span>
                    <span class="stat-value" id="stress-level">--</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        class EnhancedDashboard {
            constructor() {
                this.charts = {};
                this.data = {
                    performance: [],
                    biometric: [],
                    ceeScores: {},
                    players: []
                };
                this.isLive = false;
                this.updateInterval = null;
                this.darkMode = false;
                
                this.initializeCharts();
                this.initializeCEE();
                this.loadInitialData();
            }

            // Initialize Chart.js charts
            initializeCharts() {
                // Performance Trend Chart
                const perfCtx = document.getElementById('performance-chart').getContext('2d');
                this.charts.performance = new Chart(perfCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Performance Score',
                            data: [],
                            borderColor: '#FF6B35',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'League Average',
                            data: [],
                            borderColor: '#888',
                            borderDash: [5, 5],
                            backgroundColor: 'transparent',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: '#fff' }
                            }
                        },
                        scales: {
                            x: {
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#aaa' }
                            },
                            y: {
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#aaa' },
                                min: 0,
                                max: 100
                            }
                        }
                    }
                });

                // Biometric Chart
                const bioCtx = document.getElementById('biometric-chart').getContext('2d');
                this.charts.biometric = new Chart(bioCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Heart Rate',
                            data: [],
                            borderColor: '#FF6B35',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            x: {
                                display: false
                            },
                            y: {
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: '#aaa' },
                                min: 60,
                                max: 120
                            }
                        }
                    }
                });
            }

            // Initialize CEE Dimensions
            initializeCEE() {
                const dimensions = [
                    { id: 'clutchGene', name: 'Clutch Gene', icon: 'üéØ' },
                    { id: 'killerInstinct', name: 'Killer Instinct', icon: 'üó°Ô∏è' },
                    { id: 'flowState', name: 'Flow State', icon: 'üåä' },
                    { id: 'mentalFortress', name: 'Mental Fortress', icon: 'üè∞' },
                    { id: 'predatorMindset', name: 'Predator Mindset', icon: 'ü¶Ö' },
                    { id: 'championAura', name: 'Champion Aura', icon: 'üëë' },
                    { id: 'winnerDNA', name: 'Winner DNA', icon: 'üß¨' },
                    { id: 'beastMode', name: 'Beast Mode', icon: 'üî•' }
                ];

                const container = document.getElementById('cee-scores');
                dimensions.forEach(dim => {
                    const element = document.createElement('div');
                    element.className = 'cee-dimension';
                    element.innerHTML = `
                        <div class="dimension-name">${dim.icon} ${dim.name}</div>
                        <div class="dimension-score" id="${dim.id}-score">--</div>
                        <div class="dimension-confidence" id="${dim.id}-conf">--% conf</div>
                    `;
                    container.appendChild(element);
                });
            }

            // Load initial data
            async loadInitialData() {
                try {
                    // Show loading state
                    this.showLoading();

                    // Fetch from Worker API
                    const [analyticsRes, statsRes] = await Promise.all([
                        fetch(BlazeConfig.api.analytics),
                        fetch(BlazeConfig.api.stats)
                    ]);

                    if (analyticsRes.ok) {
                        const analytics = await analyticsRes.json();
                        this.processAnalyticsData(analytics);
                    }

                    if (statsRes.ok) {
                        const stats = await statsRes.json();
                        this.processStatsData(stats);
                    }

                    // Generate sample data if APIs fail
                    this.generateSampleData();
                    this.hideLoading();

                } catch (error) {
                    console.log('Using fallback data:', error);
                    this.generateSampleData();
                    this.hideLoading();
                }
            }

            // Process analytics data
            processAnalyticsData(data) {
                // Update CEE scores
                if (data.ceeScores) {
                    Object.entries(data.ceeScores).forEach(([key, value]) => {
                        const scoreEl = document.getElementById(`${key}-score`);
                        const confEl = document.getElementById(`${key}-conf`);
                        if (scoreEl) scoreEl.textContent = value.score.toFixed(0);
                        if (confEl) confEl.textContent = `${value.confidence.toFixed(0)}% conf`;
                    });
                }

                // Update performance chart
                if (data.performance) {
                    this.updatePerformanceChart(data.performance);
                }
            }

            // Process stats data
            processStatsData(data) {
                // Update live stats
                document.getElementById('exit-velocity').textContent = `${data.exitVelocity || 94.2} mph`;
                document.getElementById('launch-angle').textContent = `${data.launchAngle || 28}¬∞`;
                document.getElementById('sprint-speed').textContent = `${data.sprintSpeed || 27.8} ft/s`;
                document.getElementById('decision-time').textContent = `${data.decisionTime || 187} ms`;
                document.getElementById('success-rate').textContent = `${data.successRate || 72.4}%`;

                // Update team rankings
                if (data.players) {
                    this.updateTeamRankings(data.players);
                }
            }

            // Generate sample data for demo
            generateSampleData() {
                // CEE Scores
                const ceeScores = {
                    clutchGene: { score: 87 + Math.random() * 10, confidence: 85 },
                    killerInstinct: { score: 78 + Math.random() * 10, confidence: 82 },
                    flowState: { score: 92 + Math.random() * 10, confidence: 90 },
                    mentalFortress: { score: 85 + Math.random() * 10, confidence: 88 },
                    predatorMindset: { score: 81 + Math.random() * 10, confidence: 79 },
                    championAura: { score: 89 + Math.random() * 10, confidence: 87 },
                    winnerDNA: { score: 94 + Math.random() * 10, confidence: 92 },
                    beastMode: { score: 76 + Math.random() * 10, confidence: 75 }
                };

                Object.entries(ceeScores).forEach(([key, value]) => {
                    const scoreEl = document.getElementById(`${key}-score`);
                    const confEl = document.getElementById(`${key}-conf`);
                    if (scoreEl) scoreEl.textContent = value.score.toFixed(0);
                    if (confEl) confEl.textContent = `${value.confidence}% conf`;
                });

                // Performance chart data
                const labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'];
                const performanceData = labels.map(() => 70 + Math.random() * 25);
                const avgData = labels.map(() => 75);

                this.charts.performance.data.labels = labels;
                this.charts.performance.data.datasets[0].data = performanceData;
                this.charts.performance.data.datasets[1].data = avgData;
                this.charts.performance.update();

                // Generate heatmap
                this.generateHeatmap();

                // Generate team rankings
                const players = [
                    { name: 'Leo Valdez', position: 'SS', score: 94 },
                    { name: 'Marcus Johnson', position: '1B', score: 89 },
                    { name: 'Tony Rodriguez', position: 'CF', score: 87 },
                    { name: 'Jake Williams', position: '3B', score: 85 },
                    { name: 'Mike Davis', position: 'C', score: 82 }
                ];
                this.updateTeamRankings(players);

                // Update live stats
                this.updateLiveStats();
            }

            // Update performance chart
            updatePerformanceChart(data) {
                if (this.charts.performance.data.labels.length > 20) {
                    this.charts.performance.data.labels.shift();
                    this.charts.performance.data.datasets[0].data.shift();
                    this.charts.performance.data.datasets[1].data.shift();
                }

                this.charts.performance.data.labels.push(new Date().toLocaleTimeString());
                this.charts.performance.data.datasets[0].data.push(data.score);
                this.charts.performance.data.datasets[1].data.push(75); // League average
                this.charts.performance.update('none');
            }

            // Generate heatmap
            generateHeatmap() {
                const heatmap = document.getElementById('heatmap');
                heatmap.innerHTML = '';

                for (let i = 0; i < 81; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'heatmap-cell';
                    
                    const value = Math.random();
                    if (value > 0.7) {
                        cell.classList.add('heat-hot');
                        cell.textContent = 'üî•';
                    } else if (value > 0.4) {
                        cell.classList.add('heat-warm');
                        cell.textContent = '‚Ä¢';
                    } else {
                        cell.classList.add('heat-cold');
                        cell.textContent = '';
                    }
                    
                    heatmap.appendChild(cell);
                }
            }

            // Update team rankings
            updateTeamRankings(players) {
                const container = document.getElementById('team-rankings');
                container.innerHTML = '';

                players.sort((a, b) => b.score - a.score).forEach((player, index) => {
                    const item = document.createElement('div');
                    item.className = 'player-item';
                    item.innerHTML = `
                        <span class="player-name">${index + 1}. ${player.name} (${player.position})</span>
                        <span class="player-score">${player.score}</span>
                    `;
                    container.appendChild(item);
                });
            }

            // Update live stats
            updateLiveStats() {
                document.getElementById('exit-velocity').textContent = `${(90 + Math.random() * 20).toFixed(1)} mph`;
                document.getElementById('launch-angle').textContent = `${(20 + Math.random() * 20).toFixed(0)}¬∞`;
                document.getElementById('sprint-speed').textContent = `${(26 + Math.random() * 4).toFixed(1)} ft/s`;
                document.getElementById('decision-time').textContent = `${(150 + Math.random() * 100).toFixed(0)} ms`;
                document.getElementById('success-rate').textContent = `${(60 + Math.random() * 30).toFixed(1)}%`;

                // Update biometrics
                document.getElementById('heart-rate').textContent = `${(70 + Math.random() * 40).toFixed(0)} bpm`;
                document.getElementById('hrv').textContent = `${(30 + Math.random() * 30).toFixed(0)} ms`;
                const stress = Math.random();
                document.getElementById('stress-level').textContent = stress < 0.3 ? 'Low' : stress < 0.7 ? 'Medium' : 'High';

                // Update biometric chart
                this.updateBiometricChart();
            }

            // Update biometric chart
            updateBiometricChart() {
                if (this.charts.biometric.data.labels.length > 30) {
                    this.charts.biometric.data.labels.shift();
                    this.charts.biometric.data.datasets[0].data.shift();
                }

                this.charts.biometric.data.labels.push('');
                this.charts.biometric.data.datasets[0].data.push(70 + Math.random() * 40);
                this.charts.biometric.update('none');
            }

            // Control methods
            startRealTime() {
                if (this.isLive) return;
                
                this.isLive = true;
                document.getElementById('connection-status').textContent = 'LIVE ‚Ä¢ Streaming Data';
                
                this.updateInterval = setInterval(() => {
                    this.updateLiveStats();
                    this.updatePerformanceChart({ score: 70 + Math.random() * 25 });
                    
                    // Randomly update CEE scores
                    if (Math.random() > 0.7) {
                        this.generateSampleData();
                    }
                }, 2000);
            }

            pauseRealTime() {
                this.isLive = false;
                document.getElementById('connection-status').textContent = 'PAUSED ‚Ä¢ 2.8M+ Data Points';
                
                if (this.updateInterval) {
                    clearInterval(this.updateInterval);
                    this.updateInterval = null;
                }
            }

            refreshData() {
                this.loadInitialData();
                this.generateHeatmap();
            }

            async exportData() {
                const data = {
                    timestamp: new Date().toISOString(),
                    ceeScores: this.data.ceeScores,
                    performance: this.charts.performance.data.datasets[0].data,
                    players: this.data.players,
                    stats: {
                        exitVelocity: document.getElementById('exit-velocity').textContent,
                        launchAngle: document.getElementById('launch-angle').textContent,
                        sprintSpeed: document.getElementById('sprint-speed').textContent,
                        decisionTime: document.getElementById('decision-time').textContent,
                        successRate: document.getElementById('success-rate').textContent
                    }
                };

                const csv = this.convertToCSV(data);
                this.downloadCSV(csv, `blaze-analytics-${Date.now()}.csv`);
            }

            convertToCSV(data) {
                let csv = 'Blaze Intelligence Analytics Export\n';
                csv += `Timestamp,${data.timestamp}\n\n`;
                
                csv += 'CEE Scores\n';
                csv += 'Dimension,Score,Confidence\n';
                Object.entries(data.ceeScores || {}).forEach(([key, value]) => {
                    csv += `${key},${value.score},${value.confidence}\n`;
                });
                
                csv += '\nPerformance Metrics\n';
                Object.entries(data.stats || {}).forEach(([key, value]) => {
                    csv += `${key},${value}\n`;
                });
                
                return csv;
            }

            downloadCSV(csv, filename) {
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                window.URL.revokeObjectURL(url);
            }

            toggleMode() {
                this.darkMode = !this.darkMode;
                document.body.style.filter = this.darkMode ? 'invert(1)' : 'none';
            }

            showLoading() {
                // Implementation for loading state
            }

            hideLoading() {
                // Implementation for hiding loading state
            }
        }

        // Initialize dashboard
        const dashboard = new EnhancedDashboard();
        
        // Auto-start live data after 2 seconds
        setTimeout(() => {
            dashboard.startRealTime();
        }, 2000);
    </script>
</body>
</html>