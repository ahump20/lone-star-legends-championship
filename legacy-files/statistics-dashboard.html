<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lone Star Legends - Real-Time Analytics Dashboard</title>
    <style>
        body {
            margin: 0;
            font-family: 'Arial', sans-serif;
            background: radial-gradient(ellipse at center, #1a4c2b 0%, #0d2818 100%);
            color: #ffffff;
            overflow-x: hidden;
        }

        .dashboard-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: auto auto auto;
            gap: 20px;
            padding: 20px;
            min-height: 100vh;
        }

        .dashboard-header {
            grid-column: 1 / -1;
            text-align: center;
            background: linear-gradient(135deg, #2d5a3d, #1a4c2b);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #4a7c59;
        }

        .dashboard-panel {
            background: rgba(45, 90, 61, 0.8);
            border: 2px solid #4a7c59;
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .panel-title {
            color: #90EE90;
            font-size: 1.5em;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid #4a7c59;
            padding-bottom: 10px;
        }

        .champion-enigma-display {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .enigma-metric {
            text-align: center;
            background: rgba(26, 76, 43, 0.7);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #4a7c59;
            min-width: 120px;
        }

        .enigma-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #90EE90;
            margin: 10px 0;
        }

        .enigma-label {
            font-size: 0.9em;
            color: #cccccc;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 10px;
            background: rgba(26, 76, 43, 0.5);
            border-radius: 6px;
        }

        .stat-label {
            color: #cccccc;
        }

        .stat-value {
            color: #90EE90;
            font-weight: bold;
        }

        .biometric-chart {
            height: 200px;
            background: rgba(26, 76, 43, 0.3);
            border-radius: 8px;
            border: 1px solid #4a7c59;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }

        .chart-line {
            position: absolute;
            bottom: 0;
            width: 2px;
            background: #90EE90;
            border-radius: 1px 1px 0 0;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .player-card {
            background: rgba(26, 76, 43, 0.6);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #90EE90;
        }

        .player-name {
            font-size: 1.2em;
            color: #90EE90;
            margin-bottom: 5px;
        }

        .player-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .historical-trend {
            height: 150px;
            background: rgba(26, 76, 43, 0.3);
            border-radius: 8px;
            margin: 15px 0;
            position: relative;
            border: 1px solid #4a7c59;
        }

        .trend-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, #90EE90, #4a7c59);
            top: 50%;
            left: 0;
            right: 0;
            transform: translateY(-50%);
            animation: slideIn 3s ease-in-out;
        }

        @keyframes slideIn {
            from { width: 0; }
            to { width: 100%; }
        }

        .control-panel {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .control-button {
            background: linear-gradient(135deg, #4a7c59, #2d5a3d);
            border: 2px solid #90EE90;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .control-button:hover {
            background: linear-gradient(135deg, #90EE90, #4a7c59);
            color: #1a4c2b;
            transform: translateY(-2px);
        }

        .live-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            background: #ff4444;
            border-radius: 50%;
            margin-left: 10px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .performance-heatmap {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 2px;
            margin: 15px 0;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: bold;
        }

        .heat-cold { background: #1a4c2b; color: #cccccc; }
        .heat-warm { background: #4a7c59; color: white; }
        .heat-hot { background: #90EE90; color: #1a4c2b; }

        @media (max-width: 768px) {
            .dashboard-container {
                grid-template-columns: 1fr;
                padding: 10px;
            }
            
            .champion-enigma-display {
                flex-direction: column;
                gap: 10px;
            }
            
            .control-panel {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="dashboard-header">
            <h1>‚öæ Lone Star Legends Analytics Dashboard</h1>
            <p>Champion Enigma Engine‚Ñ¢ ‚Ä¢ Real-Time Performance Intelligence ‚Ä¢ Blaze Intelligence Integration</p>
            <span class="live-indicator"></span>
            <span>LIVE DATA</span>
            
            <div class="control-panel">
                <button class="control-button" onclick="startSimulation()">üöÄ Start Simulation</button>
                <button class="control-button" onclick="resetStats()">üîÑ Reset Stats</button>
                <button class="control-button" onclick="exportData()">üìä Export Data</button>
                <button class="control-button" onclick="toggleRealTime()">‚è∏Ô∏è Pause</button>
            </div>
        </div>

        <!-- Champion Enigma Engine Panel -->
        <div class="dashboard-panel">
            <div class="panel-title">üß† Champion Enigma Engine</div>
            
            <div class="champion-enigma-display">
                <div class="enigma-metric">
                    <div class="enigma-value" id="championQuotient">87</div>
                    <div class="enigma-label">Champion Quotient</div>
                </div>
                <div class="enigma-metric">
                    <div class="enigma-value" id="mentalToughness">92</div>
                    <div class="enigma-label">Mental Toughness</div>
                </div>
                <div class="enigma-metric">
                    <div class="enigma-value" id="killerInstinct">78</div>
                    <div class="enigma-label">Killer Instinct</div>
                </div>
                <div class="enigma-metric">
                    <div class="enigma-value" id="neuralEfficiency">85</div>
                    <div class="enigma-label">Neural Efficiency</div>
                </div>
            </div>

            <div class="biometric-chart" id="biometricChart">
                <!-- Real-time biometric visualization -->
            </div>

            <div class="stat-row">
                <span class="stat-label">Heart Rate Variability:</span>
                <span class="stat-value" id="hrv">45ms</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Focus Level:</span>
                <span class="stat-value" id="focusLevel">87%</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Stress Response:</span>
                <span class="stat-value" id="stressResponse">Low</span>
            </div>
        </div>

        <!-- Live Performance Metrics -->
        <div class="dashboard-panel">
            <div class="panel-title">üìä Live Performance Metrics</div>
            
            <div class="stat-row">
                <span class="stat-label">Exit Velocity (AVG):</span>
                <span class="stat-value" id="avgExitVelocity">94.2 mph</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Launch Angle (OPT):</span>
                <span class="stat-value" id="launchAngle">28¬∞</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Decision Velocity‚Ñ¢:</span>
                <span class="stat-value" id="decisionVelocity">187ms</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Batting Average:</span>
                <span class="stat-value" id="battingAvg">.342</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">OPS:</span>
                <span class="stat-value" id="ops">1.127</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Clutch Factor:</span>
                <span class="stat-value" id="clutchFactor">8.7/10</span>
            </div>

            <div class="performance-heatmap" id="performanceHeatmap">
                <!-- Performance zone heatmap -->
            </div>
        </div>

        <!-- Team Roster Analysis -->
        <div class="dashboard-panel">
            <div class="panel-title">üë• Active Roster Analysis</div>
            <div id="rosterDisplay">
                <!-- Player cards will be populated here -->
            </div>
        </div>

        <!-- Historical Trends -->
        <div class="dashboard-panel">
            <div class="panel-title">üìà Historical Performance Trends</div>
            
            <div class="historical-trend">
                <div class="trend-line"></div>
            </div>
            
            <div class="stat-row">
                <span class="stat-label">7-Day Trend:</span>
                <span class="stat-value" id="weekTrend">+12.4%</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Season High:</span>
                <span class="stat-value" id="seasonHigh">118 mph Exit Velocity</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Improvement Rate:</span>
                <span class="stat-value" id="improvementRate">+2.1% per week</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Consistency Score:</span>
                <span class="stat-value" id="consistencyScore">89.3%</span>
            </div>

            <div class="stat-row">
                <span class="stat-label">Total At-Bats Tracked:</span>
                <span class="stat-value" id="totalAtBats">1,247</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Data Points Collected:</span>
                <span class="stat-value" id="dataPoints">15,629</span>
            </div>
        </div>
    </div>

    <script>
        // Real-time statistics tracking system
        class StatsDashboard {
            constructor() {
                this.isRunning = false;
                this.historicalData = [];
                this.currentSession = {
                    startTime: Date.now(),
                    atBats: 0,
                    hits: 0,
                    homeRuns: 0,
                    totalExitVelocity: 0,
                    biometricReadings: []
                };
                this.players = [];
                this.initializeRoster();
            }

            initializeRoster() {
                // Initialize with Advanced AI Players data
                this.players = [
                    { name: "Rodriguez", position: "C", championQuotient: 87, mentalToughness: 84, killerInstinct: 78, currentForm: 92 },
                    { name: "Martinez", position: "1B", championQuotient: 82, mentalToughness: 76, killerInstinct: 88, currentForm: 85 },
                    { name: "Johnson", position: "2B", championQuotient: 75, mentalToughness: 72, killerInstinct: 67, currentForm: 79 },
                    { name: "Williams", position: "3B", championQuotient: 91, mentalToughness: 89, killerInstinct: 92, currentForm: 88 },
                    { name: "Davis", position: "SS", championQuotient: 78, mentalToughness: 81, killerInstinct: 74, currentForm: 83 },
                    { name: "Garcia", position: "LF", championQuotient: 73, mentalToughness: 69, killerInstinct: 71, currentForm: 76 },
                    { name: "Wilson", position: "CF", championQuotient: 89, mentalToughness: 87, killerInstinct: 85, currentForm: 94 },
                    { name: "Anderson", position: "RF", championQuotient: 84, mentalToughness: 79, killerInstinct: 82, currentForm: 87 },
                    { name: "Taylor", position: "DH", championQuotient: 93, mentalToughness: 91, killerInstinct: 95, currentForm: 89 }
                ];
                this.displayRoster();
            }

            displayRoster() {
                const rosterContainer = document.getElementById('rosterDisplay');
                rosterContainer.innerHTML = '';

                this.players.forEach(player => {
                    const playerCard = document.createElement('div');
                    playerCard.className = 'player-card';
                    playerCard.innerHTML = `
                        <div class="player-name">${player.name} (${player.position})</div>
                        <div class="player-stats">
                            <div>CQ: ${player.championQuotient}/100</div>
                            <div>Form: ${player.currentForm}%</div>
                            <div>Mental: ${player.mentalToughness}%</div>
                            <div>Instinct: ${player.killerInstinct}%</div>
                        </div>
                    `;
                    rosterContainer.appendChild(playerCard);
                });
            }

            start() {
                this.isRunning = true;
                this.updateLoop();
                this.biometricLoop();
                console.log('üìä Statistics Dashboard: LIVE DATA ACTIVE');
            }

            stop() {
                this.isRunning = false;
                console.log('üìä Statistics Dashboard: DATA COLLECTION PAUSED');
            }

            updateLoop() {
                if (!this.isRunning) return;

                // Simulate real-time data updates
                this.updateChampionEngineMetrics();
                this.updatePerformanceMetrics();
                this.updateBiometrics();
                this.generateHeatmap();

                setTimeout(() => this.updateLoop(), 2000); // Update every 2 seconds
            }

            biometricLoop() {
                if (!this.isRunning) return;

                this.updateBiometricChart();
                setTimeout(() => this.biometricLoop(), 500); // Faster biometric updates
            }

            updateChampionEngineMetrics() {
                // Simulate dynamic Champion Enigma metrics
                const currentPlayer = this.players[Math.floor(Math.random() * this.players.length)];
                
                // Add slight variation to base stats
                const variation = () => (Math.random() - 0.5) * 4; // ¬±2 point variation
                
                document.getElementById('championQuotient').textContent = 
                    Math.max(50, Math.min(100, currentPlayer.championQuotient + variation()));
                document.getElementById('mentalToughness').textContent = 
                    Math.max(40, Math.min(100, currentPlayer.mentalToughness + variation()));
                document.getElementById('killerInstinct').textContent = 
                    Math.max(30, Math.min(100, currentPlayer.killerInstinct + variation()));
                document.getElementById('neuralEfficiency').textContent = 
                    Math.max(50, Math.min(100, 75 + variation() * 2));
            }

            updatePerformanceMetrics() {
                // Generate realistic performance variations
                const baseExitVel = 94.2;
                const exitVelVariation = (Math.random() - 0.5) * 8;
                document.getElementById('avgExitVelocity').textContent = 
                    (baseExitVel + exitVelVariation).toFixed(1) + ' mph';

                const launchAngle = 28 + (Math.random() - 0.5) * 10;
                document.getElementById('launchAngle').textContent = launchAngle.toFixed(0) + '¬∞';

                const decisionVel = 187 + (Math.random() - 0.5) * 30;
                document.getElementById('decisionVelocity').textContent = decisionVel.toFixed(0) + 'ms';

                // Update batting stats with realistic progression
                this.currentSession.atBats++;
                if (Math.random() < 0.342) { // 34.2% hit rate
                    this.currentSession.hits++;
                }

                const avg = (this.currentSession.hits / this.currentSession.atBats) || 0;
                document.getElementById('battingAvg').textContent = avg.toFixed(3);

                document.getElementById('totalAtBats').textContent = 
                    (1247 + this.currentSession.atBats).toLocaleString();

                document.getElementById('dataPoints').textContent = 
                    (15629 + this.currentSession.atBats * 12).toLocaleString();
            }

            updateBiometrics() {
                // Simulate biometric readings
                const heartRate = 65 + Math.random() * 25;
                const hrv = 30 + Math.random() * 40;
                const focus = 70 + Math.random() * 30;
                const stress = Math.random() < 0.7 ? 'Low' : Math.random() < 0.9 ? 'Medium' : 'High';

                document.getElementById('hrv').textContent = hrv.toFixed(0) + 'ms';
                document.getElementById('focusLevel').textContent = focus.toFixed(0) + '%';
                document.getElementById('stressResponse').textContent = stress;

                // Store for historical tracking
                this.currentSession.biometricReadings.push({
                    timestamp: Date.now(),
                    heartRate,
                    hrv,
                    focus
                });

                // Keep last 50 readings
                if (this.currentSession.biometricReadings.length > 50) {
                    this.currentSession.biometricReadings.shift();
                }
            }

            updateBiometricChart() {
                const chart = document.getElementById('biometricChart');
                chart.innerHTML = ''; // Clear previous bars

                const readings = this.currentSession.biometricReadings.slice(-20); // Last 20 readings
                const maxHeight = 180;

                readings.forEach((reading, index) => {
                    const bar = document.createElement('div');
                    bar.className = 'chart-line';
                    
                    // Use heart rate for bar height (normalize 60-120 to 0-180px)
                    const normalizedHeight = ((reading.heartRate - 60) / 60) * maxHeight;
                    bar.style.height = Math.max(10, Math.min(maxHeight, normalizedHeight)) + 'px';
                    bar.style.left = (index * 5) + 'px';
                    
                    // Color based on stress level
                    if (reading.heartRate > 100) {
                        bar.style.background = '#ff6b6b';
                    } else if (reading.heartRate > 85) {
                        bar.style.background = '#ffd93d';
                    } else {
                        bar.style.background = '#90EE90';
                    }
                    
                    chart.appendChild(bar);
                });
            }

            generateHeatmap() {
                const heatmap = document.getElementById('performanceHeatmap');
                heatmap.innerHTML = '';

                // Generate 9x9 grid representing different performance zones
                for (let i = 0; i < 81; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'heatmap-cell';
                    
                    const performance = Math.random();
                    if (performance > 0.7) {
                        cell.classList.add('heat-hot');
                        cell.textContent = 'üî•';
                    } else if (performance > 0.4) {
                        cell.classList.add('heat-warm');
                        cell.textContent = '‚ñ™';
                    } else {
                        cell.classList.add('heat-cold');
                        cell.textContent = '‚ñ´';
                    }
                    
                    heatmap.appendChild(cell);
                }
            }

            reset() {
                this.currentSession = {
                    startTime: Date.now(),
                    atBats: 0,
                    hits: 0,
                    homeRuns: 0,
                    totalExitVelocity: 0,
                    biometricReadings: []
                };
                console.log('üìä Statistics Reset Complete');
            }

            exportData() {
                const exportData = {
                    session: this.currentSession,
                    historical: this.historicalData,
                    roster: this.players,
                    timestamp: new Date().toISOString()
                };

                const dataStr = "data:text/json;charset=utf-8," + 
                               encodeURIComponent(JSON.stringify(exportData, null, 2));
                const downloadElement = document.createElement('a');
                downloadElement.setAttribute("href", dataStr);
                downloadElement.setAttribute("download", "lone-star-legends-stats.json");
                downloadElement.click();
                
                console.log('üìä Statistics Data Exported Successfully');
            }
        }

        // Initialize dashboard
        const dashboard = new StatsDashboard();

        // Control functions
        function startSimulation() {
            dashboard.start();
            document.querySelector('button[onclick="startSimulation()"]').innerHTML = '‚úÖ Active';
        }

        function resetStats() {
            dashboard.reset();
            alert('üìä Statistics have been reset!');
        }

        async function exportData() {
            if (!dashboard.isActive) {
                alert('Please start the simulation first');
                return;
            }
            
            const exportType = prompt('Export type (full/team/players/games):', 'full');
            const format = prompt('Format (csv/json):', 'csv');
            
            if (!exportType || !format) return;
            
            try {
                // Show loading indicator
                const exportButton = document.querySelector('button[onclick="exportData()"]');
                const originalText = exportButton.innerHTML;
                exportButton.innerHTML = '‚è≥ Exporting...';
                exportButton.disabled = true;
                
                const response = await fetch(`/api/stats/export?type=${exportType}&format=${format}`);
                
                if (!response.ok) throw new Error('Export failed');
                
                // Create download link
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const downloadElement = document.createElement('a');
                downloadElement.href = url;
                
                const filename = response.headers.get('Content-Disposition')?.split('filename=')[1]?.replace(/"/g, '') || 
                               `blaze-statistics.${format}`;
                
                downloadElement.download = filename;
                document.body.appendChild(downloadElement);
                downloadElement.click();
                document.body.removeChild(downloadElement);
                window.URL.revokeObjectURL(url);
                
                // Restore button
                exportButton.innerHTML = originalText;
                exportButton.disabled = false;
                
                alert(`üìÅ ${format.toUpperCase()} export completed!`);
                
            } catch (error) {
                console.error('Export failed:', error);
                alert('Export failed. Please try again.');
                
                // Restore button
                const exportButton = document.querySelector('button[onclick="exportData()"]');
                exportButton.innerHTML = 'üìä Export Data';
                exportButton.disabled = false;
            }
        }

        function toggleRealTime() {
            const btn = document.querySelector('button[onclick="toggleRealTime()"]');
            if (dashboard.isRunning) {
                dashboard.stop();
                btn.innerHTML = '‚ñ∂Ô∏è Resume';
            } else {
                dashboard.start();
                btn.innerHTML = '‚è∏Ô∏è Pause';
            }
        }

        // Auto-start dashboard
        window.addEventListener('load', () => {
            setTimeout(() => {
                startSimulation();
            }, 1000);
        });

        // Integration with Advanced AI Player System
        function integrateAIPlayerData(playerData) {
            if (playerData && playerData.name) {
                const existingPlayer = dashboard.players.find(p => p.name === playerData.name);
                if (existingPlayer) {
                    // Update with real AI data
                    existingPlayer.championQuotient = playerData.getChampionQuotient();
                    const analysis = playerData.getDetailedAnalysis();
                    existingPlayer.mentalToughness = analysis.traits.mentalToughness;
                    existingPlayer.killerInstinct = analysis.traits.killerInstinct;
                    existingPlayer.currentForm = analysis.currentState.form;
                    
                    console.log(`ü§ñ AI Player Data Updated: ${playerData.name}`);
                    dashboard.displayRoster();
                }
            }
        }

        // Expose integration function globally
        window.integrateAIPlayerData = integrateAIPlayerData;
        window.dashboard = dashboard;

        console.log('üìä Lone Star Legends Analytics Dashboard Initialized');
        console.log('üß† Champion Enigma Engine: ONLINE');
        console.log('üìà Real-Time Tracking: READY');
    </script>
</body>
</html>